# Population Genetics Project

The dataset of ancient Eurasians (see [DataS1](https://github.com/sarabehnamian/Origins-of-Ancient-Eurasian-Genomes/tree/main/steps/Step%200)). The dataset contains **genetic data** of **ancient Eurasians** from **different time periods**. The data is in the form of **SNP patterns**.

Develop an interface that allows selecting **populations** and **time** and calculates the **minor allele frequencies** of the chosen populations. The program will **merge patterns** that are too close. The results will be printed on the screen as **admixture plots**.

# PLINK 1.9

[PLINK](https://www.cog-genomics.org/plink/1.9/) is a free, open-source whole genome association analysis toolset, designed to perform a range of basic, large-scale analyses in a computationally efficient manner. The focus of PLINK is purely on analysis of genotype/phenotype data, so there is no support for a file format for storing sequence data or working with the sequence data directly.

[_More..._](https://zzz.bwh.harvard.edu/plink/)

[_Tutorial_](https://zzz.bwh.harvard.edu/plink/tutorial.shtml)

**_Installation_**

```bash

condainstall-cbiocondaplink

```

ver: plink-1.90b6.21

converting the data to ped format

```bash

plink--bfileDataS1--maf0.01--recode--outs1

```

> During the filtering process, 147229 variants were loaded from the .bim file and 961 individuals were loaded from the .fam file. Among them, 526 were males, 388 were females, and 47 had ambiguous sex. 935 phenotype values were loaded from the .fam file, with 26 missing phenotypes.

> After filtering, 118837 variants and 961 individuals passed the quality control (QC) checks. Among the remaining phenotypes, 935 were controls and 0 were cases. Finally, the command outputted the converted PED/MAP files named "s1.ped" and "s1.map".

## codes presented in the jupyter notebook

## bim file

7	rs7776598	1.87147	159063152	4	3
8	rs3750097	0.000135	197042	4	2

The .bim file is one of the files generated by PLINK and contains information about the variants in a genetic dataset. Specifically, it contains the following information for each variant:

1. Chromosome number (e.g. "7" or "8")
2. Variant identifier (e.g. "rs434242" or "rs3750097")
3. Genetic distance in Morgans (not always present or accurate)
4. Physical position in base pairs (e.g. "159006635" or "197042")
5. Allele 1 (e.g. "3" or "4") - this is typically the minor allele
6. Allele 2 (e.g. "1" or "2") - this is typically the major allele

Note that the first four columns are required, while the allele columns are optional (though highly recommended). The allele values represent the alleles observed at the variant, and the numeric values correspond to the allele codes specified in the .ped file.

In general, the .bim file is used to map variants to physical locations and to provide allele information for downstream analyses such as association testing or imputation.

## ped file

The .ped file is a plain text file format used by PLINK to store genotype and phenotype data for a genetic dataset. It is one of the three files used by PLINK to store genetic data, along with the .bim and .fam files.

The .ped file has one row for each individual in the dataset, and contains the following information:

1. Family ID (e.g. "FAM123")
2. Individual ID (e.g. "IND456")
3. Paternal ID (e.g. "0" for unknown or if individual is a founder)
4. Maternal ID (e.g. "0" for unknown or if individual is a founder)
5. Sex (1=male; 2=female; 0=unknown/missing)
6. Phenotype (e.g. "1" or "2" for affected and unaffected, respectively)

After the six mandatory fields, the .ped file includes genotype information for each individual. Specifically, there is one column for each SNP in the dataset, with each genotype represented as a pair of alleles (e.g. "A G" for a heterozygous genotype or "A A" for a homozygous reference genotype).

## map file

The .map file is one of the three files used by PLINK to store genetic data for a dataset, along with the .bed and .fam files. The .map file contains information about the genetic markers (SNPs) in the dataset.

Specifically, the .map file has one row for each SNP, and contains the following information:

1. Chromosome (e.g. "1", "2", "X", etc.)
2. Marker name (e.g. "rs123456")
3. Genetic distance in Morgans (set to "0" in PLINK)
4. Physical position in base pairs (e.g. "12345678")

The .map file is typically used in combination with the .ped and .fam files to perform various analyses in PLINK, such as genome-wide association studies (GWAS) or linkage analyses. Together, these three files comprise the PLINK binary file format (Plink binary PED format).

Note that the .map file is a plain text file that can be easily read and edited by humans using a text editor or spreadsheet software. However, it is usually generated automatically by PLINK and should not be edited manually, as this could result in errors in downstream analyses.

# fam file

The .fam file is another file generated by PLINK and contains information about the individuals in a genetic dataset. Specifically, it contains the following information for each individual:

1. Family ID (e.g. "Russia" or "Germany")
2. Individual ID (e.g. "DA249" or "Falkenstein")
3. Paternal ID (e.g. "0" for unknown)
4. Maternal ID (e.g. "0" for unknown)
5. Sex (1=male; 2=female; 0=unknown/missing)
6. Phenotype (e.g. "1" or "-9" for unaffected and missing, respectively)

Note that the first two columns (family and individual ID) are required, while the remaining columns are optional. The paternal and maternal IDs are used to infer family structure (i.e. who is related to whom), while the sex and phenotype columns are often used in downstream analyses such as association testing or quality control.

In the example you provided, the first individual (Russia DA249) has unknown parents, an unknown sex, and a missing phenotype, while the second individual (Germany Falkenstein) has unknown parents, is female (sex=2), and has an affected phenotype (phenotype=1).


bim: variant identifier and minor allele
ped: familly id and individual id and allels
excell = indv ID and time
